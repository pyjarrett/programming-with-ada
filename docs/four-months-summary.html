

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Summary after Four Months with Ada &mdash; Programming with Ada  documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/my_theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/my_theme.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="author" title="About these documents" href="about.html" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Ray Tracing in One Weekend… in Ada" href="ray-tracing-in-one-weekend.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> Programming with Ada
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="features.html">Feature Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="five-structural-elements.html">The Big Five Structural Elements</a></li>
<li class="toctree-l1"><a class="reference internal" href="packages.html">Note on Terminology</a></li>
<li class="toctree-l1"><a class="reference internal" href="packages.html#packages-the-building-blocks-of-ada">Packages, the Building Blocks of Ada</a></li>
<li class="toctree-l1"><a class="reference internal" href="advanced-techniques.html">Advanced Techniques</a></li>
<li class="toctree-l1"><a class="reference internal" href="being-terse.html">Being More Terse</a></li>
<li class="toctree-l1"><a class="reference internal" href="comparison.html">Comparing Ada to Other Languages</a></li>
<li class="toctree-l1"><a class="reference internal" href="comparison.html#terminology">Terminology</a></li>
<li class="toctree-l1"><a class="reference internal" href="about.html">About</a></li>
<li class="toctree-l1"><a class="reference internal" href="ray-tracing-in-one-weekend.html">Ray Tracing in One Weekend… in Ada</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Summary after Four Months with Ada</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#why">Why?</a></li>
<li class="toctree-l2"><a class="reference internal" href="#resources">Resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="#projects">Projects</a></li>
<li class="toctree-l2"><a class="reference internal" href="#ecosystem">Ecosystem</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#alire">Alire</a></li>
<li class="toctree-l3"><a class="reference internal" href="#gnat">GNAT</a></li>
<li class="toctree-l3"><a class="reference internal" href="#editors">Editors</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#cross-platform-behavior">Cross-Platform Behavior</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#community">Community</a></li>
<li class="toctree-l2"><a class="reference internal" href="#adacore-and-ada-modernization">AdaCore and Ada Modernization</a></li>
<li class="toctree-l2"><a class="reference internal" href="#a-free-function-focused-c-or-a-strongly-typed-c">A Free-Function Focused C++, or a Strongly Typed C</a></li>
<li class="toctree-l2"><a class="reference internal" href="#spark">SPARK</a></li>
<li class="toctree-l2"><a class="reference internal" href="#focus-on-intent">Focus on Intent</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#parameter-modes">Parameter Modes</a></li>
<li class="toctree-l3"><a class="reference internal" href="#derived-types">Derived Types</a></li>
<li class="toctree-l3"><a class="reference internal" href="#enumeration-types">Enumeration Types</a></li>
<li class="toctree-l3"><a class="reference internal" href="#pre-and-post-conditions">Pre- and Post-Conditions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#protected-objects">Protected Objects</a></li>
<li class="toctree-l3"><a class="reference internal" href="#tasks">Tasks</a></li>
<li class="toctree-l3"><a class="reference internal" href="#generics">Generics</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#low-level-control">Low Level Control</a></li>
<li class="toctree-l2"><a class="reference internal" href="#vocabulary">Vocabulary</a></li>
<li class="toctree-l2"><a class="reference internal" href="#verboseness">Verboseness</a></li>
<li class="toctree-l2"><a class="reference internal" href="#was-it-worth-it">Was it worth it?</a></li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Programming with Ada</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Summary after Four Months with Ada</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/four-months-summary.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">

           <div itemprop="articleBody">
            
  <div class="section" id="summary-after-four-months-with-ada">
<h1>Summary after Four Months with Ada<a class="headerlink" href="#summary-after-four-months-with-ada" title="Permalink to this headline">¶</a></h1>
<p>For the last four months I’ve been learning and writing Ada 2012.
I wanted to share my experiences with the language for those who aren’t familiar with it.
I’m neither endorsing or denouncing Ada.
For those unfamiliar with Ada terms, I’ll using the vernacular common to C family languages.
This will make Ada programmers cringe, but will be much more clear to the general reader.</p>
<p>When I refer to “Ada” here, I’m referring to Ada 2012 and the SPARK 2014 language,
which is a subset of Ada 2012 used for formal verification.</p>
<div class="section" id="why">
<h2>Why?<a class="headerlink" href="#why" title="Permalink to this headline">¶</a></h2>
<p>Ada’s an obscure language.
It’s been around for decades and strong opinions about it existed in the past, but overall it seems forgotten outside its niche.
When I mention I made things in it, I’ve gotten baffled responses of “That language is still around?”
Another comment was, “I’ve never heard of anyone else ever working, or having working in Ada.”</p>
<p>I’ve written code in a variety of languages, but Ada by far is the most bizarre and strangely familiar one at the same time.
My intent was to mess around with it for a few weekends and move on, but it wasn’t the “dead language” I expected.
There’s been a lot of modernization in the last couple of years, which makes it a surprisingly modern language to work in.</p>
</div>
<div class="section" id="resources">
<h2>Resources<a class="headerlink" href="#resources" title="Permalink to this headline">¶</a></h2>
<p>These are listed in order of what I used:</p>
<ul>
<li><p><a class="reference external" href="https://learn.adacore.com/">learn.adacore.com</a></p>
<blockquote>
<div><ul class="simple">
<li><p>A good tutorial site.  It’s enough to get you started.</p></li>
</ul>
</div></blockquote>
</li>
<li><p><a class="reference external" href="https://www.amazon.com/Programming-Ada-2012-John-Barnes/dp/110742481X">John Barnes “Programming in Ada 2012”</a></p>
<blockquote>
<div><ul class="simple">
<li><p>Barnes works on several major Ada references, and this book walks through the language.
At over 700 pages, it took me abotu a month to get through.</p></li>
<li><p>This seems to be a common way Ada programmers get onboarded, and Ada programmers
stay updated.</p></li>
</ul>
</div></blockquote>
</li>
<li><p><a class="reference external" href="https://en.m.wikibooks.org/wiki/Ada_Programming">Ada Language Wikibook</a></p>
<blockquote>
<div><ul class="simple">
<li><p>This is exceptionally good and very complete.</p></li>
</ul>
</div></blockquote>
</li>
<li><p><a class="reference external" href="https://github.com/ohenley/awesome-ada">Awesome-Ada</a></p>
<blockquote>
<div><ul class="simple">
<li><p>A site with way more resources than I list here.</p></li>
</ul>
</div></blockquote>
</li>
<li><p><a class="reference external" href="http://ada-auth.org/standards/rm12_w_tc1/RM-Final.pdf">Ada Reference Manual</a></p>
<blockquote>
<div><ul class="simple">
<li><p>Authoritative reference about how Ada <strong>should</strong> work.</p></li>
</ul>
</div></blockquote>
</li>
<li><p><a class="reference external" href="https://www.amazon.com/Building-High-Integrity-Applications-SPARK/dp/1107656842/ref=sr_1_2?dchild=1&amp;keywords=Building+High+Integrity+Applications+with+SPARK&amp;qid=1630108759&amp;s=books&amp;sr=1-2">Building High Integrity Applications with SPARK</a></p>
<blockquote>
<div><ul class="simple">
<li><p>It’s ok, the first third of the book is an Ada crash couse before it gets into SPARK.</p></li>
</ul>
</div></blockquote>
</li>
</ul>
</div>
<div class="section" id="projects">
<h2>Projects<a class="headerlink" href="#projects" title="Permalink to this headline">¶</a></h2>
<p>During this timeframe I made a few projects:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pyjarrett/septum">Septum</a> - context-based source code search</p></li>
<li><p><a class="reference external" href="https://github.com/pyjarrett/dir_iterators">dir_iterators</a> - library similar to the incredible <a class="reference external" href="https://github.com/BurntSushi/walkdir">walkdir</a></p></li>
<li><p><a class="reference external" href="https://github.com/pyjarrett/progress_indicators">project_indicators</a> - library for spinners and progress bars</p></li>
<li><p><a class="reference external" href="https://github.com/pyjarrett/trendy_terminal">trendy_terminal</a> - library for cross-platform terminal setup</p></li>
<li><p><a class="reference external" href="https://github.com/pyjarrett/trendy_test">trendy_test</a> - library for simple unit testing</p></li>
<li><p><a class="reference external" href="https://github.com/pyjarrett/ada-ray-tracer">Ada Ray Tracer</a> - a port of <a class="reference external" href="https://raytracing.github.io/books/RayTracingInOneWeekend.html">Ray Tracing in One Weekend</a>)</p></li>
<li><p><a class="reference external" href="https://github.com/pyjarrett/dirs_to_graphviz">dirs_to_graphviz</a> : Make graphviz files from directory trees</p></li>
</ul>
</div>
<div class="section" id="ecosystem">
<h2>Ecosystem<a class="headerlink" href="#ecosystem" title="Permalink to this headline">¶</a></h2>
<div class="section" id="alire">
<h3>Alire<a class="headerlink" href="#alire" title="Permalink to this headline">¶</a></h3>
<p><a class="reference external" href="https://alire.ada.dev/">Alire</a> simplifies Ada development significantly, by simplifying project generation,
building, running, and dependency management.</p>
<p>It borrows <strong>heavily</strong> from Cargo, and if “good artists borrow, great artists steal,” then Ada is on par with Michaelangelo.
In its quest for modernizing, many concepts of Rust’s cargo are being built into this tool.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>alr build

alr run

alr edit
</pre></div>
</div>
<p>Before Alire, I had a a lot of confusion about “How do I use ______ project as a dependency?” and with Alire it’s one command line and go.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Add dir_iterators library</span>
alr with dir_iterators
</pre></div>
</div>
<p>This tool only went to 1.0 since I’ve been working with Ada and it simplifies development considerably.
Alire interfaces with the pre-existing tool <a class="reference external" href="https://docs.adacore.com/gprbuild-docs/html/gprbuild_ug.html">grpbuild</a>, which is a common interface into the GNAT ecosystem and tools.
Since it wraps it, you can do additional configuration past the initial setup, and it works well with GNAT Studio, one of the major editors.
You can also set the config to run any other editor command with environment variables setup, such as Visual Studio Code:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>alr config --set editor.cmd <span class="s2">&quot;code .&quot;</span>
</pre></div>
</div>
<p>Toolchains are integrated into Alire as of <a class="reference external" href="https://github.com/alire-project/alire/releases/tag/v1.1.0-rc1">the 1.1 release candidate</a>,
so it’s becoming a one-stop shop for what you need.</p>
<p>However, there’s a few hoops to jump through to get a crate into the manager.
For now, every package and version update requires manual approval.
This is supposed to prevent name squatting and ensures existing libraries can get their appropriate names.
It still can be frustrating waiting for approval, though things usually get approved within a day or so.
You can use local versions as a dependency, which helps when developing libraries,
and keeps you moving if you’re waiting that day for approval.</p>
<p>Overall, Alire is a fantastic tool which makes working with Ada easy and I wouldn’t recommend learning Ada without it.</p>
</div>
<div class="section" id="gnat">
<h3>GNAT<a class="headerlink" href="#gnat" title="Permalink to this headline">¶</a></h3>
<p>The major Ada ecosystem is <a class="reference external" href="https://gcc.gnu.org/wiki/GNAT">GNAT</a>.  Yes, there supposedly are
commercially supported compilers and <a class="reference external" href="https://www.adacore.com/gnatpro/comparison">AdaCore offers paid support</a>,
but the Free Software Foundation (FSF) offers a Ada front-end to GCC.  This is usually referred to as “FSF GNAT”.</p>
<p>Can I use Ada for free?  Yes, if you can use GCC for your project, you can use Ada.
You can grab the FSF GNAT toolchain with Alire 1.1 and <code class="docutils literal notranslate"><span class="pre">alr</span> <span class="pre">toolchain</span> <span class="pre">--select</span> <span class="pre">gnat_native</span></code>.</p>
<p>The entire ecosystem is designed around running tools from the command line, which allows editors
and CI to use the same actions for behaviors.  For example, GNAT Studio just wraps many of the GNAT
tools and it shows you the command line for the actions you want to use.  This acts as training wheels
if you want to get started quickly and then transition to using another editor,
especially a terminal one like Emacs or Vim.</p>
<p>There’s a lot of parts to GNAT, which is a super deep dive I’m not interested in doing here.
To give an idea, there’s a formatter (<code class="docutils literal notranslate"><span class="pre">gnatpp</span></code>) and a document generator (<code class="docutils literal notranslate"><span class="pre">gnatdoc</span></code>).</p>
<ul class="simple">
<li><p><a class="reference external" href="https://gcc.gnu.org/onlinedocs/gcc-11.2.0/gnat_rm/">GNAT Reference Manual</a></p></li>
<li><p><a class="reference external" href="https://gcc.gnu.org/onlinedocs/gcc-11.2.0/gnat_ugn/">GNAT User’s Guide for Native Platforms</a></p></li>
</ul>
<p>There is also an <a class="reference external" href="https://github.com/AdaCore/gnat-llvm">LLVM frontend for Ada</a> in progress.
It’d be exciting to see this integrated as a toolchain you can download with Alire.</p>
</div>
<div class="section" id="editors">
<h3>Editors<a class="headerlink" href="#editors" title="Permalink to this headline">¶</a></h3>
<p>If you believe reddit, editor usage is split roughly in thirds between GNAT Studio and Visual Studio Code,
with Emacs/Vim balanced in the remaining third.</p>
<p>The big editor is <a class="reference external" href="https://github.com/AdaCore/gps">GNAT Studio</a>,
which used to be known as “GPS”, and supports Ada, C and C++.  It comes bundled with GNAT Community
Edition, but you can build and run it separately as well.  There’s some quirky behavior,
like <cite>tab</cite> indenting to where it thinks the indent should be and not actually inserting a tab,
and some obscure keyboard shortcuts, but otherwise is a mature IDE experience.  You can make and
export your own keybindings, <a class="reference external" href="https://github.com/pyjarrett/gps_keybindings">which I’ve done for Visual Studio</a>
which I should probably contribute back at some point.</p>
<p>There’s also support for <a class="reference external" href="https://www.reddit.com/r/ada/comments/p29o7r/tutorial_using_ada_in_vs_code/">Visual Studio code</a>,
which relies on the <a class="reference external" href="https://github.com/AdaCore/ada_language_server">Ada Language Server</a>.</p>
<p>A coordinated set of <a class="reference external" href="https://github.com/thindil/vim-ada">Vim plugins</a> is available for those who want to go that route.</p>
<p>I had been primarily using GNAT Studio and then moved over to Visual Studio code, you can get
a good editing experience with either one of these.</p>
<p>I’m not an Emacs user, so I’m not familiar with how folks work in that environment.</p>
<div class="section" id="cross-platform-behavior">
<h4>Cross-Platform Behavior<a class="headerlink" href="#cross-platform-behavior" title="Permalink to this headline">¶</a></h4>
<p>Alire hooks into <a class="reference external" href="https://docs.adacore.com/gprbuild-docs/html/gprbuild_ug.html">GPRbuild’s</a> external
variable system for cross-platform behavior.
In general, I haven’t had to mess with GPR configurations too much since Alire wraps it well and provides good defaults on project creation.</p>
<p>This is the Alire side, describing the external values to set for gprbuild to do the “right thing.”</p>
<p>Just like in cargo, we have a <code class="docutils literal notranslate"><span class="pre">.toml</span></code> describing the build.</p>
<div class="highlight-TOML notranslate"><div class="highlight"><pre><span></span><span class="c1"># alire.toml</span>
<span class="c1"># Platform selection by Alire on download.</span>
<span class="k">[gpr-set-externals.&#39;case(os)&#39;]</span>
<span class="n">windows</span> <span class="o">=</span> <span class="p">{</span> <span class="n">Trendy_Terminal_Platform</span> <span class="o">=</span> <span class="s">&quot;windows&quot;</span> <span class="p">}</span>
<span class="n">linux</span> <span class="o">=</span> <span class="p">{</span> <span class="n">Trendy_Terminal_Platform</span> <span class="o">=</span> <span class="s">&quot;linux&quot;</span> <span class="p">}</span>
<span class="n">macos</span> <span class="o">=</span> <span class="p">{</span> <span class="n">Trendy_Terminal_Platform</span> <span class="o">=</span> <span class="s">&quot;macos&quot;</span> <span class="p">}</span>
</pre></div>
</div>
<p>On the GPR side, we select the source we want to use, since Ada doesn’t have a common preprocessor.
GNAT has a preprocessor but it seems frowned upon to use it.</p>
<div class="highlight-Ada notranslate"><div class="highlight"><pre><span></span><span class="c1">-- my_project.gpr</span>
<span class="kd">type</span> <span class="kt">Platform_Type</span> <span class="kr">is</span> <span class="p">(</span><span class="s">&quot;windows&quot;</span><span class="p">,</span> <span class="s">&quot;linux&quot;</span><span class="p">,</span> <span class="s">&quot;macos&quot;</span><span class="p">);</span>
<span class="n">Platform</span> <span class="p">:</span> <span class="n">Platform_Type</span> <span class="p">:=</span> <span class="n">external</span> <span class="p">(</span><span class="s">&quot;Trendy_Terminal_Platform&quot;</span><span class="p">);</span>
<span class="kr">case</span> <span class="n">Platform</span> <span class="kr">is</span>
    <span class="kr">when</span> <span class="s">&quot;windows&quot;</span> <span class="p">=&gt;</span> <span class="n">Trendy_Terminal_Sources</span> <span class="p">:=</span> <span class="n">Trendy_Terminal_Sources</span> <span class="o">&amp;</span> <span class="s">&quot;src/windows&quot;</span><span class="p">;</span>
    <span class="kr">when</span> <span class="s">&quot;linux&quot;</span>   <span class="p">=&gt;</span> <span class="n">Trendy_Terminal_Sources</span> <span class="p">:=</span> <span class="n">Trendy_Terminal_Sources</span> <span class="o">&amp;</span> <span class="s">&quot;src/linux&quot;</span><span class="p">;</span>
    <span class="kr">when</span> <span class="s">&quot;macos&quot;</span>   <span class="p">=&gt;</span> <span class="n">Trendy_Terminal_Sources</span> <span class="p">:=</span> <span class="n">Trendy_Terminal_Sources</span> <span class="o">&amp;</span> <span class="s">&quot;src/mac&quot;</span><span class="p">;</span>
<span class="kr">end</span> <span class="kr">case</span><span class="p">;</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="community">
<h2>Community<a class="headerlink" href="#community" title="Permalink to this headline">¶</a></h2>
<p>The online Ada community is exceptionally small.
Online counts in <a class="reference external" href="https://www.reddit.com/r/ada/">r/ada</a> hover in the mid twenties, compared to Rust’s ~900, and seem to peak in the 50s.</p>
<p>Despite the size, the community is extremely knowledgeable and
there’s a lot of folks with decades of Ada experience chomping at the bit to answer questions.
This means Reddit and Stack Overflow answers regularly include the applicable language rule’s section and paragraph from the Ada Reference Manual.</p>
<p>An interesting aside is that if Github locations are to be believed, the Ada community is predominantly European.
This correlates with what I’ve seen, since I’m in the US Eastern time zone, people online tend to be very active in the morning.</p>
</div>
<div class="section" id="adacore-and-ada-modernization">
<h2>AdaCore and Ada Modernization<a class="headerlink" href="#adacore-and-ada-modernization" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://www.adacore.com/">AdaCore</a> didn’t invent Ada, so they’re not a direct comparison to Mozilla with Rust,
but they did help develop GNAT originally, and continue to contribute back.
I’m sure there’s other companies promoting Ada, but they seem to be the most visible.</p>
<p>It looks like there was a huge burst of activity after the release of Ada 2012,
including a lot of <a class="reference external" href="https://www.youtube.com/playlist?list=PLkoa8uxigENkneyEEeDWVPgpMhPc9IJ7o">quite-detailed YouTube videos</a>
and marketing.</p>
<p>The second wave promoting Ada now seems to be getting better traction and community involvement.
AdaCore <a class="reference external" href="https://github.com/AdaCore">open-sourced a lot of libraries</a> and have been the primary group I’ve seen promoting the language.
The movement they’re pushing seems to be the right direction: building an LLVM front-end to the language, a language server,
open-sourcing a lot of libraries, creating learning resources and improving IDE support.</p>
<p>The modernization push is intense.
There is a marked improvement working in the language even in the short time span I’ve seen.
It’s gone from “a quirky and sometimes clunky car” to feeling “modern.”</p>
</div>
<div class="section" id="a-free-function-focused-c-or-a-strongly-typed-c">
<h2>A Free-Function Focused C++, or a Strongly Typed C<a class="headerlink" href="#a-free-function-focused-c-or-a-strongly-typed-c" title="Permalink to this headline">¶</a></h2>
<p>Ada focuses on creating packages of code which contain types and functions.
There’s no preprocessor, so instead of <code class="docutils literal notranslate"><span class="pre">#include</span></code>, you <code class="docutils literal notranslate"><span class="pre">with</span></code> packages which contain what you need.</p>
<div class="highlight-Ada notranslate"><div class="highlight"><pre><span></span><span class="kn">with</span> <span class="nn">RT.Vecs</span><span class="p">;</span> <span class="c1">-- depend on another package, RT.Vecs</span>

<span class="kd">package</span> <span class="nc">RT.Rays</span> <span class="kr">is</span>
    <span class="kn">use</span> <span class="nn">RT.Vecs</span><span class="p">;</span>  <span class="c1">-- use the names inside RT.Vecs</span>

    <span class="kd">type</span> <span class="kt">Ray</span> <span class="kr">is</span> <span class="kr">record</span>
        <span class="n">Origin</span>    <span class="p">:</span> <span class="n">Point3</span><span class="p">;</span>
        <span class="n">Direction</span> <span class="p">:</span> <span class="n">Vec3</span><span class="p">;</span>
    <span class="kr">end record</span><span class="p">;</span>

    <span class="kd">function</span> <span class="nf">Point_At</span><span class="p">(</span><span class="nv">R</span> <span class="p">: </span><span class="nv">Ray</span><span class="p">;</span> <span class="nv">T</span><span class="p">: </span><span class="nv">F32</span><span class="p">)</span> <span class="kr">return</span> <span class="n">Point3</span><span class="p">;</span>

<span class="kr">end</span> <span class="nf">RT.Rays</span><span class="p">;</span>
</pre></div>
</div>
<p>Packages are namespaces for functions and types, unlike other languages where types can “contain” functions and types.
Function overloading acts as a key design element, made clear by the lack of implicit casts.</p>
<div class="highlight-Ada notranslate"><div class="highlight"><pre><span></span><span class="c1">-- Idiomatic versions of &quot;ToString&quot;</span>
<span class="kd">function</span> <span class="nf">Image</span><span class="p">(</span><span class="nv">S</span> <span class="p">: </span><span class="nv">Some_Type</span><span class="p">)</span> <span class="kr">return</span> <span class="kt">String</span><span class="p">;</span>
<span class="kd">function</span> <span class="nf">Image</span><span class="p">(</span><span class="nv">A</span> <span class="p">: </span><span class="nv">Another_Type</span><span class="p">)</span> <span class="kr">return</span> <span class="kt">String</span><span class="p">;</span>
</pre></div>
</div>
<p>Everything in a package is related, there’s no syntactical split between “free function”, “class function”, or “member function” (method).</p>
<div class="highlight-Ada notranslate"><div class="highlight"><pre><span></span><span class="kd">package</span> <span class="nc">RT.Vecs</span> <span class="kr">is</span>
    <span class="kd">type</span> <span class="kt">Vec3</span> <span class="kr">is</span> <span class="kr">record</span>
        <span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span> <span class="p">:</span> <span class="n">F32</span> <span class="p">:=</span> <span class="mf">0.0</span><span class="p">;</span>
    <span class="kr">end record</span><span class="p">;</span>

    <span class="kd">function</span> <span class="nf">Length</span> <span class="p">(</span><span class="nv">V</span> <span class="p">: </span><span class="nv">Vec3</span><span class="p">)</span> <span class="kr">return</span> <span class="n">F32</span><span class="p">;</span>

    <span class="c1">-- Is this a free function, a class function or a member function (method)?</span>
    <span class="c1">-- It doesn&#39;t really matter, because it&#39;s declared the same.</span>
    <span class="kd">function</span> <span class="nf">Dot</span> <span class="p">(</span><span class="nv">A</span><span class="p">,</span> <span class="nv">B</span> <span class="p">: </span><span class="nv">Vec3</span><span class="p">)</span> <span class="kr">return</span> <span class="n">F32</span><span class="p">;</span>
<span class="kr">end</span> <span class="nf">RT.Vecs</span>
</pre></div>
</div>
<p>Functions get declared similarly, with parameter type and ordering describing the difference between C++’s “free functions” vs instance functions.
A class type as a leading parameter determines if one would be considered a member function (“methods”).
There’s a concept called “primitive operations” which describe bringing in operations of a parent type (even primitive, like Integer) where this matters.</p>
<div class="highlight-Ada notranslate"><div class="highlight"><pre><span></span><span class="kd">package</span> <span class="nc">SP.Filters</span> <span class="kr">is</span>
    <span class="c1">-- An empty &quot;abstract class&quot;</span>
    <span class="kd">type</span> <span class="kt">Filter</span> <span class="kr">is</span> <span class="kr">abstract</span> <span class="kr">tagged</span> <span class="kr">null record</span><span class="p">;</span>

    <span class="c1">-- A &quot;pure virtual method&quot;</span>
    <span class="kd">function</span> <span class="nf">Matches_Line</span> <span class="p">(</span><span class="nv">F</span> <span class="p">: </span><span class="nv">Filter</span><span class="p">;</span> <span class="nv">Str</span> <span class="p">: </span><span class="nv">String</span><span class="p">)</span> <span class="kr">return</span> <span class="kt">Boolean</span> <span class="kr">is</span> <span class="kr">abstract</span><span class="p">;</span>

    <span class="c1">-- Accepts any derived class of Filter</span>
    <span class="kd">function</span> <span class="nf">Matches_File</span> <span class="p">(</span><span class="nv">F</span> <span class="p">: </span><span class="nv">Filter</span><span class="p">&#39;</span><span class="na">Class</span><span class="p">;</span> <span class="nv">Lines</span> <span class="p">: </span><span class="nv">String_Vectors</span><span class="p">.</span><span class="nv">Vector</span><span class="p">)</span> <span class="kr">return</span> <span class="kt">Boolean</span><span class="p">;</span>

    <span class="c1">-- A &quot;subclass&quot;</span>
    <span class="kd">type</span> <span class="kt">Case_Sensitive_Match_Filter</span> <span class="kr">is</span> <span class="kr">new</span> <span class="n">Filter</span> <span class="kr">with</span> <span class="kr">record</span>
        <span class="n">Text</span> <span class="p">:</span> <span class="n">Unbounded_String</span><span class="p">;</span>
    <span class="kr">end record</span><span class="p">;</span>

    <span class="c1">-- An overridden method of a base class.</span>
    <span class="kr">overriding</span> <span class="kd">function</span> <span class="nf">Matches_Line</span> <span class="p">(</span><span class="nv">F</span> <span class="p">: </span><span class="nv">Case_Sensitive_Match_Filter</span><span class="p">;</span> <span class="nv">Str</span> <span class="p">: </span><span class="nv">String</span><span class="p">)</span> <span class="kr">return</span> <span class="kt">Boolean</span><span class="p">;</span>

    <span class="c1">-- &quot;Free-function&quot; which is just part of the package.</span>
    <span class="kd">function</span> <span class="nf">Is_Quoted</span> <span class="p">(</span><span class="nv">S</span> <span class="p">: </span><span class="nv">String</span><span class="p">)</span> <span class="kr">return</span> <span class="kt">Boolean</span><span class="p">;</span>
<span class="kr">end</span> <span class="nf">SP.Filters</span>
</pre></div>
</div>
<p>Packages are split between a “specification” (.ads file) and a “body” (.adb file), akin to the “header” and “source”
files you encounter in C/C++, though this distinction is understood at the language level.
Since physical design matters in ways similar to C and C++, some physical design techniques in <a class="reference external" href="https://www.amazon.com/Large-Scale-Software-Design-John-Lakos/dp/0201633620">Lakos’ Large-Scale C++ Software Design</a>
book actually work.</p>
<div class="highlight-Ada notranslate"><div class="highlight"><pre><span></span><span class="kd">package</span> <span class="kd">body</span> <span class="nc">RT.Rays</span> <span class="kr">is</span>
    <span class="c1">-- Use all the operators of Vec3</span>
    <span class="kn">use</span> <span class="nn">all</span> <span class="kd">type</span> <span class="kt">RT</span><span class="p">.</span><span class="n">Vecs</span><span class="p">.</span><span class="n">Vec3</span><span class="p">;</span>

    <span class="kd">function</span> <span class="nf">Point_At</span><span class="p">(</span><span class="nv">R</span> <span class="p">: </span><span class="nv">Ray</span><span class="p">;</span> <span class="nv">T</span><span class="p">: </span><span class="nv">F32</span><span class="p">)</span> <span class="kr">return</span> <span class="n">Point3</span> <span class="kr">is</span> <span class="p">(</span><span class="n">R</span><span class="p">.</span><span class="n">Origin</span> <span class="o">+</span> <span class="n">T</span> <span class="o">*</span> <span class="n">R</span><span class="p">.</span><span class="n">Direction</span><span class="p">);</span>
<span class="kr">end</span> <span class="nf">RT.Rays</span><span class="p">;</span>
</pre></div>
</div>
<p>Packages can contain startup code executed by the “environment task” prior to entering the main procedure for initialization.
Unlike C++, there are language pragmas you can use to control order of initialization of these elements.</p>
<div class="highlight-Ada notranslate"><div class="highlight"><pre><span></span><span class="kd">package</span> <span class="kd">body</span> <span class="nc">RT.Debug</span> <span class="kr">is</span>
<span class="kr">begin</span>
    <span class="n">Ada</span><span class="p">.</span><span class="n">Text_IO</span><span class="p">.</span><span class="n">Put_Line</span><span class="p">(</span><span class="s">&quot;Executed before the program enters the main function!&quot;</span><span class="p">);</span>
<span class="kr">end</span> <span class="nf">RT.Debug</span><span class="p">;</span>
</pre></div>
</div>
</div>
<div class="section" id="spark">
<h2>SPARK<a class="headerlink" href="#spark" title="Permalink to this headline">¶</a></h2>
<p>SPARK is a subset of Ada I glazed over earlier.
It’s a language for formal verification which you can intermingle with Ada code.
Think of it as sort of like <code class="docutils literal notranslate"><span class="pre">extern</span> <span class="pre">C</span></code> in C++, or <code class="docutils literal notranslate"><span class="pre">unsafe</span></code> in Rust, except it marks code as undergoing verification.
Since it’s a subset of Ada, in addition to verification, you get all the rest of the Ada tooling here, like Alire.
Yes, there are SPARK formally verified crates in Alire, such as a <a class="reference external" href="https://alire.ada.dev/crates/sparknacl">formally verified implementation of NaCl</a>.</p>
</div>
<div class="section" id="focus-on-intent">
<h2>Focus on Intent<a class="headerlink" href="#focus-on-intent" title="Permalink to this headline">¶</a></h2>
<div class="section" id="parameter-modes">
<h3>Parameter Modes<a class="headerlink" href="#parameter-modes" title="Permalink to this headline">¶</a></h3>
<p>Ada source focuses on describing intent and modeling semantics.</p>
<p>I misled you earlier for expediency.
What most C-family languages call “functions”, Ada calls “subprograms”.
Ada distinguishes between those which return a value and are truly “functions” and those which do not return a value, and are “procedures.”</p>
<p>For example, subprogram parameters can be either <code class="docutils literal notranslate"><span class="pre">in</span></code>, <code class="docutils literal notranslate"><span class="pre">out</span></code>, or both.
<code class="docutils literal notranslate"><span class="pre">in</span></code> parameters are readonly, and while you can force passing by reference via specifics in the language, you often just ignore how this happens.
Parameters are implicitly <code class="docutils literal notranslate"><span class="pre">in</span></code>, so you can omit that if you want.
This is common in SPARK code because <code class="docutils literal notranslate"><span class="pre">out</span></code> parameters are forbidden.</p>
<div class="highlight-Ada notranslate"><div class="highlight"><pre><span></span><span class="c1">-- Receives and modifies a parameter.</span>
<span class="kd">procedure</span> <span class="nf">Clear_Filters</span> <span class="p">(</span><span class="nv">Srch</span> <span class="p">: </span><span class="nv">in</span> <span class="nv">out</span> <span class="nv">Search</span><span class="p">);</span>

<span class="c1">-- Like a &quot;const&quot; member function in C++, which can&#39;t modify its argument</span>
<span class="c1">-- Could also be declared like this:</span>
<span class="c1">-- function Num_Files (Srch : Search) return Natural;</span>
<span class="kd">function</span> <span class="nf">Num_Files</span> <span class="p">(</span><span class="nv">Srch</span> <span class="p">: </span><span class="nv">in</span> <span class="nv">Search</span><span class="p">)</span> <span class="kr">return</span> <span class="kt">Natural</span><span class="p">;</span>
</pre></div>
</div>
</div>
<div class="section" id="derived-types">
<h3>Derived Types<a class="headerlink" href="#derived-types" title="Permalink to this headline">¶</a></h3>
<p>Describing semantics goes all the way into primitive types, and the rules are consistent between primitive and user-defined types.
Creating lightweight types with domain-specific meaning, prevents mishandling of semantics on primitive types due to no implicit casting.
Interfaces rarely use <code class="docutils literal notranslate"><span class="pre">Integer</span></code> or <code class="docutils literal notranslate"><span class="pre">Float</span></code> directly, instead you’ll find semantic versions (“derived types”) created such as “Meters” or “Kilometers”.</p>
<div class="highlight-Ada notranslate"><div class="highlight"><pre><span></span><span class="kd">type</span> <span class="kt">Seconds</span> <span class="kr">is</span> <span class="kr">new</span> <span class="kt">Natural</span><span class="p">;</span>
<span class="kd">type</span> <span class="kt">Milliseconds</span> <span class="kr">is</span> <span class="kr">new</span> <span class="kt">Natural</span><span class="p">;</span>

<span class="n">S</span> <span class="p">:</span> <span class="n">Seconds</span> <span class="p">:=</span> <span class="mi">10</span><span class="p">;</span>
<span class="n">M</span> <span class="p">:</span> <span class="n">Milliseconds</span> <span class="p">:=</span> <span class="mi">50</span><span class="p">;</span>

<span class="n">M</span> <span class="p">:=</span> <span class="n">S</span><span class="p">;</span>                       <span class="c1">-- Compile error!</span>
<span class="n">M</span> <span class="p">:=</span> <span class="n">Milliseconds</span> <span class="p">(</span><span class="mi">1000</span> <span class="o">*</span> <span class="n">S</span><span class="p">);</span> <span class="c1">-- Allowed because I told compiler it&#39;s ok</span>
</pre></div>
</div>
<p>Function overloading checks parameters as well as return types, so creating functions and transforms of types is straightforward.</p>
<div class="highlight-Ada notranslate"><div class="highlight"><pre><span></span><span class="kd">procedure</span> <span class="nf">Update</span> <span class="p">(</span><span class="nv">S</span> <span class="p">: </span><span class="nv">Seconds</span><span class="p">);</span>
<span class="kd">procedure</span> <span class="nf">Update</span> <span class="p">(</span><span class="nv">M</span> <span class="p">: </span><span class="nv">Milliseconds</span><span class="p">);</span>

<span class="kd">function</span> <span class="nf">Delta_Time</span> <span class="nf">return</span> <span class="nf">Seconds</span><span class="p">;</span>
<span class="kd">function</span> <span class="nf">Delta_Time</span> <span class="nf">return</span> <span class="nf">Milliseconds</span><span class="p">;</span>
</pre></div>
</div>
<p>Compile and runtime checks provide bounds-checking and numerical types can have their bounds constrained to “known good” values.</p>
<div class="highlight-Ada notranslate"><div class="highlight"><pre><span></span><span class="c1">-- Let&#39;s write this with our own defined range, only allowing less than 60 seconds.</span>
<span class="kd">type</span> <span class="kt">Seconds</span> <span class="kr">is</span> <span class="kr">new</span> <span class="kt">Integer</span> <span class="kr">range</span> <span class="mi">0</span> <span class="p">..</span> <span class="mi">59</span><span class="p">;</span>
</pre></div>
</div>
<p>You can also access the ranges of types with the <code class="docutils literal notranslate"><span class="pre">'First</span></code> and <code class="docutils literal notranslate"><span class="pre">'Last</span></code> attributes (read as “tick first” and “tick last”).</p>
<div class="highlight-Ada notranslate"><div class="highlight"><pre><span></span><span class="kr">pragma</span> <span class="cp">Assert</span><span class="p">(</span><span class="n">Seconds</span><span class="p">&#39;</span><span class="na">First</span> <span class="o">=</span> <span class="mi">0</span><span class="p">);</span>
<span class="kr">pragma</span> <span class="cp">Assert</span><span class="p">(</span><span class="n">Seconds</span><span class="p">&#39;</span><span class="na">Last</span> <span class="o">=</span> <span class="mi">59</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="section" id="enumeration-types">
<h3>Enumeration Types<a class="headerlink" href="#enumeration-types" title="Permalink to this headline">¶</a></h3>
<p>Enumeration types have first class support, with many automatically generated attributes.
<code class="docutils literal notranslate"><span class="pre">'First</span></code> and <code class="docutils literal notranslate"><span class="pre">'Last</span></code> get the bounds of the values and <code class="docutils literal notranslate"><span class="pre">'Pred</span></code> (predecessor) and <code class="docutils literal notranslate"><span class="pre">'Succ</span></code> move between individual values.
Iteration over all values and conversions to and from strings and integers gets provided for free.
Together, these attributes and iteration capability allow writing of generic code which operates on discrete types like integers, or enumerations.</p>
<div class="highlight-Ada notranslate"><div class="highlight"><pre><span></span><span class="kn">with</span> <span class="nn">Ada.Unchecked_Conversion</span><span class="p">;</span>

<span class="kd">type</span> <span class="kt">Filter_Action</span> <span class="kr">is</span> <span class="p">(</span><span class="nv">Keep</span><span class="p">,</span> <span class="nv">Exclude</span><span class="p">);</span>

<span class="c1">-- Specify internal values for the enumeration (optional).</span>
<span class="kr">for</span> <span class="n">Filter_Action</span> <span class="kn">use</span> <span class="p">(</span>
    <span class="n">Keep</span> <span class="p">=&gt;</span> <span class="mi">2</span><span class="p">,</span>
    <span class="n">Exclude</span> <span class="p">=&gt;</span> <span class="mi">3</span>
<span class="p">);</span>

<span class="c1">-- Allow conversion to get the values out</span>
<span class="kd">function</span> <span class="nf">Repr</span> <span class="kr">is</span> <span class="kr">new</span> <span class="n">Ada</span><span class="p">.</span><span class="n">Unchecked_Conversion</span><span class="p">(</span><span class="n">Filter_Action</span><span class="p">,</span> <span class="kt">Integer</span><span class="p">);</span>

<span class="kd">procedure</span> <span class="nf">Print_Actions</span> <span class="kr">is</span>
<span class="kr">begin</span>
    <span class="c1">-- Which order are they in?</span>
    <span class="kr">pragma</span> <span class="cp">Assert</span><span class="p">(</span><span class="n">Keep</span> <span class="o">=</span> <span class="n">Filter_Action</span><span class="p">&#39;</span><span class="na">Val</span><span class="p">(</span><span class="mi">0</span><span class="p">));</span>
    <span class="kr">pragma</span> <span class="cp">Assert</span><span class="p">(</span><span class="n">Exclude</span> <span class="o">=</span> <span class="n">Filter_Action</span><span class="p">&#39;</span><span class="na">Val</span><span class="p">(</span><span class="mi">1</span><span class="p">));</span>
    <span class="kr">pragma</span> <span class="cp">Assert</span><span class="p">(</span><span class="mi">0</span> <span class="o">=</span> <span class="n">Filter_Action</span><span class="p">&#39;</span><span class="na">Pos</span><span class="p">(</span><span class="n">Keep</span><span class="p">));</span>
    <span class="kr">pragma</span> <span class="cp">Assert</span><span class="p">(</span><span class="mi">1</span> <span class="o">=</span> <span class="n">Filter_Action</span><span class="p">&#39;</span><span class="na">Pos</span><span class="p">(</span><span class="n">Exclude</span><span class="p">));</span>

    <span class="c1">-- Comparison operators</span>
    <span class="kr">pragma</span> <span class="cp">Assert</span><span class="p">(</span><span class="n">Keep</span> <span class="o">/=</span> <span class="n">Exclude</span><span class="p">);</span>  <span class="c1">-- /= is Ada&#39;s not equal (i.e. !=)</span>
    <span class="kr">pragma</span> <span class="cp">Assert</span><span class="p">(</span><span class="n">Keep</span> <span class="o">&lt;</span> <span class="n">Exclude</span><span class="p">);</span>

    <span class="kr">pragma</span> <span class="cp">Assert</span><span class="p">(</span><span class="n">Filter_Action</span><span class="p">&#39;</span><span class="na">First</span> <span class="o">=</span> <span class="n">Keep</span><span class="p">);</span>
    <span class="kr">pragma</span> <span class="cp">Assert</span><span class="p">(</span><span class="n">Filter_Action</span><span class="p">&#39;</span><span class="na">Last</span> <span class="o">=</span> <span class="n">Exclude</span><span class="p">);</span>
    <span class="kr">pragma</span> <span class="cp">Assert</span><span class="p">(</span><span class="n">Filter_Action</span><span class="p">&#39;</span><span class="na">Succ</span><span class="p">(</span><span class="n">Keep</span><span class="p">)</span> <span class="o">=</span> <span class="n">Exclude</span><span class="p">);</span>
    <span class="kr">pragma</span> <span class="cp">Assert</span><span class="p">(</span><span class="n">Filter_Action</span><span class="p">&#39;</span><span class="na">Pred</span><span class="p">(</span><span class="n">Exclude</span><span class="p">)</span> <span class="o">=</span> <span class="n">Keep</span><span class="p">);</span>

    <span class="c1">-- Parsing from string</span>
    <span class="kr">pragma</span> <span class="cp">Assert</span><span class="p">(</span><span class="n">Filter_Action</span><span class="p">&#39;</span><span class="na">Value</span><span class="p">(</span><span class="s">&quot;KEEP&quot;</span><span class="p">)</span> <span class="o">=</span> <span class="n">Keep</span><span class="p">);</span>
    <span class="kr">pragma</span> <span class="cp">Assert</span><span class="p">(</span><span class="n">Filter_Action</span><span class="p">&#39;</span><span class="na">Value</span><span class="p">(</span><span class="s">&quot;Exclude&quot;</span><span class="p">)</span> <span class="o">=</span> <span class="n">Exclude</span><span class="p">);</span>

    <span class="c1">-- Getting underlying representation</span>
    <span class="kr">pragma</span> <span class="cp">Assert</span><span class="p">(</span><span class="mi">2</span> <span class="o">=</span> <span class="n">Repr</span><span class="p">(</span><span class="n">Keep</span><span class="p">));</span>
    <span class="kr">pragma</span> <span class="cp">Assert</span><span class="p">(</span><span class="mi">3</span> <span class="o">=</span> <span class="n">Repr</span><span class="p">(</span><span class="n">Exclude</span><span class="p">));</span>

    <span class="kr">for</span> <span class="n">Action</span> <span class="ow">in</span> <span class="n">Filter_Action</span> <span class="kr">loop</span>
        <span class="n">Ada</span><span class="p">.</span><span class="n">Text_IO</span><span class="p">.</span><span class="n">Put_Line</span><span class="p">(</span><span class="n">Action</span><span class="p">&#39;</span><span class="na">Image</span><span class="p">);</span>  <span class="c1">-- Prints KEEP and then EXCLUDE</span>
    <span class="kr">end</span> <span class="kr">loop</span><span class="p">;</span>
<span class="kr">end</span> <span class="nf">Print_Actions</span><span class="p">;</span>
</pre></div>
</div>
<p>Since arrays operate using a discrete type as an index, enumerations can be used as the type to index into an array.</p>
<div class="highlight-Ada notranslate"><div class="highlight"><pre><span></span><span class="kd">type</span> <span class="kt">Test_Status</span> <span class="kr">is</span> <span class="p">(</span><span class="nv">Passed</span><span class="p">,</span> <span class="nv">Failed</span><span class="p">,</span> <span class="nv">Skipped</span><span class="p">);</span>
<span class="kd">type</span> <span class="kt">Test_Report</span> <span class="kr">is</span> <span class="kr">array</span> <span class="p">(</span><span class="n">Test_Status</span><span class="p">)</span> <span class="kr">of</span> <span class="kt">Natural</span><span class="p">;</span>

<span class="kd">procedure</span> <span class="nf">Foo</span> <span class="kr">is</span>
    <span class="n">Report</span> <span class="p">:</span> <span class="n">Test_Report</span><span class="p">;</span>
<span class="kr">begin</span>
    <span class="c1">-- ...</span>

    <span class="c1">-- Increment number of passed tests.</span>
    <span class="n">Report</span><span class="p">(</span><span class="n">Passed</span><span class="p">)</span> <span class="p">:=</span> <span class="n">Report</span><span class="p">(</span><span class="n">Passed</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>

    <span class="c1">-- ...</span>
</pre></div>
</div>
</div>
<div class="section" id="pre-and-post-conditions">
<h3>Pre- and Post-Conditions<a class="headerlink" href="#pre-and-post-conditions" title="Permalink to this headline">¶</a></h3>
<p>Ada 2012 adds built-in support for pre and post conditions, through the use of “aspects.”
This is a “killer feature” of Ada 2012, on top of all of the other type checking and safety checking.
Though used in SPARK analyses, you can also write them in plain Ada 2012 code and as part of specification of the function.
Clients can see it as part of the interface and the compiler inserts these runtime checks if enabled.
A lot of languages have an assertion mechanism which often effectively gets used for these checks, but it’s nice to have a client-visible built-in way of doing this
I’ve also found that adding pre and post condition checks during debugging to be a very effective tool.</p>
<div class="highlight-Ada notranslate"><div class="highlight"><pre><span></span><span class="kd">function</span> <span class="nf">Merge</span> <span class="p">(</span><span class="nv">A</span><span class="p">,</span> <span class="nv">B</span> <span class="p">: </span><span class="nv">Context_Match</span><span class="p">)</span> <span class="kr">return</span> <span class="n">Context_Match</span> <span class="kn">with</span>
    <span class="nn">Pre</span>  <span class="p">=&gt;</span> <span class="n">Is_Valid</span> <span class="p">(</span><span class="n">A</span><span class="p">)</span> <span class="ow">and then</span> <span class="n">Is_Valid</span> <span class="p">(</span><span class="n">B</span><span class="p">),</span>
    <span class="n">Post</span> <span class="p">=&gt;</span> <span class="n">Is_Valid</span> <span class="p">(</span><span class="n">Merge</span><span class="p">&#39;</span><span class="na">Result</span><span class="p">);</span>
</pre></div>
</div>
<p>Types which expose no private state can also have type invariants which are checked prior to usage as function arguments and after assignments.</p>
<div class="highlight-Ada notranslate"><div class="highlight"><pre><span></span><span class="kd">type</span> <span class="kt">Spinner</span> <span class="kr">is</span> <span class="kr">record</span>
    <span class="n">Ticks_Per_Move</span> <span class="p">:</span> <span class="kt">Positive</span><span class="p">;</span>
    <span class="n">Ticks</span>          <span class="p">:</span> <span class="kt">Natural</span><span class="p">;</span>
    <span class="n">State</span>          <span class="p">:</span> <span class="n">Spinner_State</span><span class="p">;</span>
    <span class="n">Style</span>          <span class="p">:</span> <span class="n">Spinner_Style</span><span class="p">;</span>
<span class="kr">end record</span> <span class="kr">with</span>
    <span class="n">Type_Invariant</span> <span class="p">=&gt;</span> <span class="n">Ticks</span> <span class="o">&lt;</span> <span class="n">Ticks_Per_Move</span><span class="p">;</span>
</pre></div>
</div>
</div>
<div class="section" id="protected-objects">
<h3>Protected Objects<a class="headerlink" href="#protected-objects" title="Permalink to this headline">¶</a></h3>
<p>Protected objects coordinate concurrent access to shared state.
The control can also include arbitrarily complex conditionals as well, such as not allowing any writers when readers exist, or blocking any more readers when a writer is waiting.</p>
<div class="highlight-Ada notranslate"><div class="highlight"><pre><span></span><span class="kd">protected</span> <span class="kr">body</span> <span class="n">Concurrent_Context_Results</span> <span class="kr">is</span>
    <span class="c1">-- Calling Get_Results will wait for Pending_Results to equal 0.</span>
    <span class="kd">entry</span> <span class="nf">Get_Results</span> <span class="p">(</span><span class="nv">Out_Results</span> <span class="p">: </span><span class="nv">out</span> <span class="nv">SP</span><span class="p">.</span><span class="nv">Contexts</span><span class="p">.</span><span class="nv">Context_Vectors</span><span class="p">.</span><span class="nv">Vector</span><span class="p">)</span>
        <span class="kr">when</span> <span class="n">Pending_Results</span> <span class="o">=</span> <span class="mi">0</span> <span class="kr">is</span>
    <span class="kr">begin</span>
        <span class="n">Out_Results</span> <span class="p">:=</span> <span class="n">Results</span><span class="p">;</span>
    <span class="kr">end</span> <span class="nf">Get_Results</span><span class="p">;</span>

    <span class="kd">procedure</span> <span class="nf">Wait_For</span> <span class="p">(</span><span class="nv">Num_Results</span> <span class="p">: </span><span class="nv">Natural</span><span class="p">)</span> <span class="kr">is</span>
    <span class="kr">begin</span>
        <span class="n">Pending_Results</span> <span class="p">:=</span> <span class="n">Num_Results</span><span class="p">;</span>
    <span class="kr">end</span> <span class="nf">Wait_For</span><span class="p">;</span>

    <span class="kd">procedure</span> <span class="nf">Add_Result</span> <span class="p">(</span><span class="nv">More</span> <span class="p">: </span><span class="nv">SP</span><span class="p">.</span><span class="nv">Contexts</span><span class="p">.</span><span class="nv">Context_Vectors</span><span class="p">.</span><span class="nv">Vector</span><span class="p">)</span> <span class="kr">is</span>
    <span class="kr">begin</span>
        <span class="n">Results</span><span class="p">.</span><span class="n">Append</span> <span class="p">(</span><span class="n">More</span><span class="p">);</span>
        <span class="n">Pending_Results</span> <span class="p">:=</span> <span class="n">Pending_Results</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span>
    <span class="kr">end</span> <span class="nf">Add_Result</span><span class="p">;</span>
<span class="kr">end</span> <span class="nf">Concurrent_Context_Results</span><span class="p">;</span>
</pre></div>
</div>
</div>
<div class="section" id="tasks">
<h3>Tasks<a class="headerlink" href="#tasks" title="Permalink to this headline">¶</a></h3>
<p>Tasks provide concurrent execution.
Additionally, they have special procedures called “entries” which can be “accepted” by a related task during its flow of execution to synchronize (rendezvous) with other tasks and share data at these points.</p>
<p>Tasks run concurrently in the block in which they’re declared, and the block will not exit until the task finishes or terminates, unless it is allocated on the heap.</p>
<p>Both single instance and instantiable versions of protected objects and tasks can be created.</p>
<div class="highlight-Ada notranslate"><div class="highlight"><pre><span></span><span class="kd">task</span> <span class="kd">type</span> <span class="kt">File_Loader_Task</span> <span class="kr">is</span>
    <span class="kd">entry</span> <span class="nf">Wake</span><span class="p">;</span>
<span class="kr">end</span> <span class="nf">File_Loader_Task</span><span class="p">;</span>

<span class="kd">task</span> <span class="kr">body</span> <span class="n">File_Loader_Task</span> <span class="kr">is</span>
    <span class="n">Elem</span> <span class="p">:</span> <span class="n">Ada</span><span class="p">.</span><span class="n">Strings</span><span class="p">.</span><span class="n">Unbounded</span><span class="p">.</span><span class="n">Unbounded_String</span><span class="p">;</span>
<span class="kr">begin</span>
    <span class="c1">-- Concurrent execution starts here when the task is created.</span>

    <span class="c1">-- Don&#39;t proceed until the &quot;Wake&quot; Entry has been called.</span>
    <span class="kr">select</span>
        <span class="kr">accept</span> <span class="n">Wake</span><span class="p">;</span>
    <span class="kr">or</span>
        <span class="c1">-- If Wake was never received the program can terminate</span>
        <span class="c1">-- this task if needed to exit the block.</span>
        <span class="kr">terminate</span><span class="p">;</span>
    <span class="kr">end</span> <span class="kr">select</span><span class="p">;</span>

    <span class="kr">loop</span>
        <span class="kr">select</span>
            <span class="c1">-- Blocking dequeue</span>
            <span class="n">File_Queue</span><span class="p">.</span><span class="n">Dequeue</span> <span class="p">(</span><span class="n">Elem</span><span class="p">);</span>
        <span class="kr">or</span>
            <span class="c1">-- Timeout: we waited 1 second, and nothing else to process</span>
            <span class="c1">-- was on the queue, so quit this task.</span>
            <span class="kr">delay</span> <span class="mf">1.0</span><span class="p">;</span>
            <span class="kr">exit</span><span class="p">;</span>
        <span class="kr">end</span> <span class="kr">select</span><span class="p">;</span>

        <span class="kr">if</span> <span class="n">Is_Text</span> <span class="p">(</span><span class="n">Elem</span><span class="p">)</span> <span class="kr">then</span>
            <span class="n">Cache_File</span> <span class="p">(</span><span class="n">File_Cache</span><span class="p">,</span> <span class="n">Elem</span><span class="p">);</span>
        <span class="kr">end</span> <span class="kr">if</span><span class="p">;</span>

        <span class="c1">-- &quot;Progress&quot; is an (unshown) declared variable in the same scope</span>
        <span class="c1">-- as the task, so the task has access to it.</span>
        <span class="n">Progress</span><span class="p">.</span><span class="n">Finish_Work</span> <span class="p">(</span><span class="mi">1</span><span class="p">);</span>
    <span class="kr">end</span> <span class="kr">loop</span><span class="p">;</span>
<span class="kr">end</span> <span class="nf">File_Loader_Task</span><span class="p">;</span>
</pre></div>
</div>
</div>
<div class="section" id="generics">
<h3>Generics<a class="headerlink" href="#generics" title="Permalink to this headline">¶</a></h3>
<p>Ada generics are similar to ML signatures, and may contain types, functions and even other packages as parameters.
Generic packages or functions must be explicitly instantiated for use.
This eliminates the debate of angled brackes (&lt;&gt;) versus square brackets for generics ([]), but leads to additional names being created.
This makes their usage and their cost explicit, at the expense of verboseness.</p>
<div class="highlight-Ada notranslate"><div class="highlight"><pre><span></span><span class="c1">-- Instantiate a generic package which contains an</span>
<span class="c1">-- Ada equivalent to std::vector&lt;std::string&gt;</span>
<span class="kd">package</span> <span class="nc">String_Vectors</span> <span class="kr">is new</span> <span class="nc">Ada.Containers.Vectors</span><span class="p">(</span>
        <span class="nv">Index_Type</span>   <span class="p">=&gt;</span> Positive<span class="p">,</span>
        <span class="nv">Element_Type</span> <span class="p">=&gt;</span> Ada.Strings.Unbounded.Unbounded_String<span class="p">,</span>
        <span class="nv">&quot;=&quot;</span>          <span class="p">=&gt;</span> Ada.Strings.Unbounded.&quot;<span class="o">=</span>&quot;<span class="p">);</span>

<span class="c1">-- Since String_Vectors is a package, Vector is the actual vector type.</span>
<span class="c1">-- There are more related types in the instantiated package.</span>
<span class="kd">function</span> <span class="nf">Shell_Split</span> <span class="p">(</span><span class="nv">S</span> <span class="p">: </span><span class="nv">Ada</span><span class="p">.</span><span class="nv">Strings</span><span class="p">.</span><span class="nv">Unbounded</span><span class="p">.</span><span class="nv">Unbounded_String</span><span class="p">)</span> <span class="kr">return</span> <span class="n">String_Vectors</span><span class="p">.</span><span class="n">Vector</span><span class="p">;</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="low-level-control">
<h2>Low Level Control<a class="headerlink" href="#low-level-control" title="Permalink to this headline">¶</a></h2>
<p>Accessing C functions and compiler intrinsics is straightforward.
You create a declaration of the subprogram and then describe where it comes from using aspects or the <code class="docutils literal notranslate"><span class="pre">Import</span></code> pragma.</p>
<div class="highlight-Ada notranslate"><div class="highlight"><pre><span></span><span class="kn">with</span> <span class="nn">Interfaces.C</span><span class="p">;</span>

<span class="kd">type</span> <span class="kt">FD</span> <span class="kr">is</span> <span class="kr">new</span> <span class="n">Interfaces</span><span class="p">.</span><span class="n">C</span><span class="p">.</span><span class="n">int</span><span class="p">;</span>
<span class="kd">function</span> <span class="nf">isatty</span> <span class="p">(</span><span class="nv">File_Descriptor</span> <span class="p">: </span><span class="nv">FD</span><span class="p">)</span> <span class="kr">return</span> <span class="n">BOOL</span>
    <span class="kn">with</span> <span class="nn">Import</span>     <span class="p">=&gt;</span> <span class="kc">True</span><span class="p">,</span>
         <span class="n">Convention</span> <span class="p">=&gt;</span> <span class="n">C</span><span class="p">;</span>

<span class="c1">-- Bring in the stdout file pointer from C</span>
<span class="kd">type</span> <span class="kt">FILE_Ptr</span> <span class="kr">is</span> <span class="kr">new</span> <span class="n">System</span><span class="p">.</span><span class="kt">Address</span><span class="p">;</span>
<span class="n">stdout</span> <span class="p">:</span> <span class="kr">aliased</span> <span class="n">FILE_Ptr</span><span class="p">;</span>
<span class="kr">pragma</span> <span class="cp">Import</span> <span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="n">stdout</span><span class="p">,</span> <span class="s">&quot;stdout&quot;</span><span class="p">);</span>
</pre></div>
</div>
<p>Since the usage is the same as with an Ada function, imported functions can be replaced with actual Ada code if needed.
Inline assembler is also available, but due to the lack of a preprocessor, the build system (gpr) is leveraged to choose the appropriate definition (body) file to compile.</p>
<div class="highlight-Ada notranslate"><div class="highlight"><pre><span></span><span class="kd">function</span> <span class="nf">File_Line</span> <span class="nf">return</span> <span class="nf">Natural</span><span class="p">;</span>
<span class="kr">pragma</span> <span class="cp">Import</span> <span class="p">(</span><span class="n">Intrinsic</span><span class="p">,</span> <span class="n">File_Line</span><span class="p">,</span> <span class="s">&quot;__builtin_LINE&quot;</span><span class="p">);</span>
</pre></div>
</div>
<p>Representation clauses allow you to match struct layout or binary formats such as for files.</p>
<div class="highlight-Ada notranslate"><div class="highlight"><pre><span></span><span class="kd">type</span> <span class="kt">Bitmap_File_Header</span> <span class="kr">is</span> <span class="kr">record</span>
    <span class="n">Identifier</span>      <span class="p">:</span> <span class="n">Integer_16</span><span class="p">;</span>
    <span class="n">File_Size_Bytes</span> <span class="p">:</span> <span class="n">Integer_32</span><span class="p">;</span>
    <span class="n">Reserved</span>        <span class="p">:</span> <span class="n">Integer_16</span> <span class="p">:=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="n">Reserved2</span>       <span class="p">:</span> <span class="n">Integer_16</span> <span class="p">:=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="n">Offset</span>          <span class="p">:</span> <span class="n">Integer_32</span><span class="p">;</span>
<span class="kr">end record</span> <span class="kr">with</span>
    <span class="n">Size</span> <span class="p">=&gt;</span> <span class="kt">Byte</span> <span class="o">*</span> <span class="mi">14</span><span class="p">;</span>

<span class="kr">for</span> <span class="n">Bitmap_File_Header</span> <span class="kn">use</span> <span class="nn">record</span>
    <span class="n">Identifier</span>      <span class="kr">at</span>  <span class="mi">0</span> <span class="kr">range</span> <span class="mi">0</span> <span class="p">..</span> <span class="mi">15</span><span class="p">;</span>
    <span class="n">File_Size_Bytes</span> <span class="kr">at</span>  <span class="mi">2</span> <span class="kr">range</span> <span class="mi">0</span> <span class="p">..</span> <span class="mi">31</span><span class="p">;</span>
    <span class="n">Reserved</span>        <span class="kr">at</span>  <span class="mi">6</span> <span class="kr">range</span> <span class="mi">0</span> <span class="p">..</span> <span class="mi">15</span><span class="p">;</span>
    <span class="n">Reserved2</span>       <span class="kr">at</span>  <span class="mi">8</span> <span class="kr">range</span> <span class="mi">0</span> <span class="p">..</span> <span class="mi">15</span><span class="p">;</span>
    <span class="n">Offset</span>          <span class="kr">at</span> <span class="mi">10</span> <span class="kr">range</span> <span class="mi">0</span> <span class="p">..</span> <span class="mi">31</span><span class="p">;</span>
<span class="kr">end</span> <span class="kr">record</span><span class="p">;</span>
</pre></div>
</div>
</div>
<div class="section" id="vocabulary">
<h2>Vocabulary<a class="headerlink" href="#vocabulary" title="Permalink to this headline">¶</a></h2>
<p>Ada suffers from a lack of familiarity for many programmers due to being a Pascal family language and also its peculiar, but very specific vocabulary.
However, the usage of keywords over punctuation helps ease many problems of dealing with an unfamiliar language.
While this helps with googling and a lot of terms appear in code, many are specific to, or have Ada-specific definitions.
Examples are “accesses” (sort of like pointers), “accesibility” (similar to a scope for borrowing),
“tagged types” (classes), “derived types” (unrelated to OOP), and “subprogram”.</p>
</div>
<div class="section" id="verboseness">
<h2>Verboseness<a class="headerlink" href="#verboseness" title="Permalink to this headline">¶</a></h2>
<p>The language has a mind of its own as well.
As <a class="reference external" href="https://people.cs.kuleuven.be/~dirk.craeynest/quotes.html">one online quote says</a>,</p>
<blockquote class="epigraph">
<div><p>When I find myself fighting the [Ada] language, it usually means that I need to revisit my design.</p>
</div></blockquote>
<p>I’ve found this to be true overall.
Ada makes some easy things verbose and some verbose things easy.
When things go from “verbose” to “writing like a Charles Dickens novels”, that’s when I rethink my approach to the problem.
There’s usually a significantly better and shorted way to accomplish the task.</p>
</div>
<div class="section" id="was-it-worth-it">
<h2>Was it worth it?<a class="headerlink" href="#was-it-worth-it" title="Permalink to this headline">¶</a></h2>
<p>If I were never to write Ada again, I still learned a lot about program correctness.
Correctness isn’t usually a fun language feature to talk about and no one likes to admit they write bugs.
Ada excels at modeling your program in the language while automating a lot of error checking.
For example, you may know you’re not going to use the full range of an integer, and Ada enables specification and automatic checking of valid values.
Combined with built-in pre and post conditions, this has helped me improve the way I think while programming.</p>
</div>
</div>


           </div>
           
          </div>
    <a href="https://github.com/pyjarrett/programming-with-ada">
        <img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png" alt="Fork me on GitHub">
    </a>

          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="ray-tracing-in-one-weekend.html" class="btn btn-neutral float-left" title="Ray Tracing in One Weekend… in Ada" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>